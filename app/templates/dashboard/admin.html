{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="container py-4">

  <h2 class="fw-bold mb-2">ðŸ›  Admin Dashboard</h2>
<<<<<<< HEAD
  <p class="text-muted mb-4">Approve farmer weighed products</p>

  <div class="card shadow-sm border-0">
=======
  <p class="text-muted mb-4">
    Approve farmer weighed products
  </p>

  <div class="card shadow-sm border-0">

>>>>>>> 24211ea (Updated AI search, weighing system, admin approval, dashboards)
    <div class="card-header fw-bold">
      Pending Weigh Logs
    </div>

    <div class="card-body p-0">

      {% if logs %}
      <div class="table-responsive">
<<<<<<< HEAD
      <table class="table mb-0 table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>Farmer</th>
=======

      <table class="table mb-0 table-hover align-middle">

        <thead class="table-light">
          <tr>
            <th>Farmer</th>
            <th>Contact</th>
>>>>>>> 24211ea (Updated AI search, weighing system, admin approval, dashboards)
            <th>Location</th>
            <th>Product</th>
            <th>Weight</th>
            <th>Price/kg</th>
            <th>Total Value</th>
            <th>Action</th>
          </tr>
        </thead>

        <tbody>
<<<<<<< HEAD
          {% for log in logs %}
          <tr>

            <!-- FARMER -->
            <td>
              <div class="fw-semibold">
                {{ log.farmer.full_name or log.farmer.username }}
              </div>
              <small class="text-muted">
                ID: {{ log.farmer.id }}
              </small>
            </td>

            <!-- LOCATION -->
            <td>
              {{ log.farmer.city }},
              {{ log.farmer.province }}
            </td>

            <!-- PRODUCT -->
            <td>
              {{ log.product_name }}
=======
        {% for log in logs %}
          <tr>

            <!-- FARMER INFO -->
            <td>
              <div class="fw-semibold">
                {{ log.farmer_name }}
              </div>
              <small class="text-muted">
                ID: {{ log.farmer_id }}
              </small>
            </td>

            <!-- CONTACT -->
            <td>
              {{ log.phone }}
            </td>

            <!-- LOCATION -->
            <td>
              {{ log.barangay }},
              {{ log.city }},
              {{ log.province }}
            </td>

            <!-- PRODUCT -->
            <td class="fw-semibold">
              {{ log.product }}
>>>>>>> 24211ea (Updated AI search, weighing system, admin approval, dashboards)
            </td>

            <!-- WEIGHT -->
            <td class="fw-bold text-success">
<<<<<<< HEAD
              {{ log.weight_kg }} kg
            </td>

            <!-- PRICE INPUT -->
            <td>
              <form action="{{ url_for('admin.approve_log', log_id=log.id) }}"
                    method="POST"
                    class="d-flex gap-2">

                <input type="number"
                       name="price"
                       step="0.01"
                       value="{{ log.farmer.price_per_kg }}"
                       required
                       class="form-control form-control-sm"
                       style="width:120px;">
            </td>

            <!-- AUTO TOTAL PREVIEW -->
            <td>
              â‚±{{ "%.2f"|format(log.weight_kg * (log.farmer.price_per_kg or 0)) }}
            </td>

            <!-- APPROVE BUTTON -->
            <td>
                <button type="submit"
                        class="btn btn-sm btn-success">
                  Approve
                </button>
              </form>
            </td>

          </tr>
          {% endfor %}
        </tbody>
=======
              {{ log.weight }} kg
            </td>

            <!-- PRICE -->
            <td>
              â‚±{{ "%.2f"|format(log.suggested_price or 0) }}
            </td>

            <!-- TOTAL -->
            <td class="fw-bold">
              â‚±{{
                "%.2f"|format(
                  (log.weight or 0) *
                  (log.suggested_price or 0)
                )
              }}
            </td>

            <!-- ACTION -->
            <td>
              <a href="{{ url_for('admin.approve_log', log_id=log.id) }}"
                 class="btn btn-sm btn-success">
                 Approve
              </a>
            </td>

          </tr>
        {% endfor %}
        </tbody>

>>>>>>> 24211ea (Updated AI search, weighing system, admin approval, dashboards)
      </table>
      </div>

      {% else %}
      <div class="text-center py-4 text-muted">
        No pending weigh logs.
      </div>
      {% endif %}

    </div>
  </div>

</div>
{% endblock %}

{% block extra_js %}
<script>
setInterval(function(){
<<<<<<< HEAD
    location.reload();
=======
  location.reload();
>>>>>>> 24211ea (Updated AI search, weighing system, admin approval, dashboards)
}, 5000);
</script>
{% endblock %}